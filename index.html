<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>–†–ï–®–ê–¢–ï–õ–¨ üé∞</title>

<style>
*{box-sizing:border-box}

body{
    margin:0;
    min-height:100vh;
    display:flex;
    justify-content:center;
    align-items:center;
    font-family:system-ui,Arial,sans-serif;
    background:radial-gradient(circle at top,#1b1f2a,#07080d);
    color:#fff
}

.box{
    width:100%;
    max-width:460px;
    background:rgba(20,24,36,.9);
    backdrop-filter:blur(14px);
    border-radius:26px;
    padding:26px;
    box-shadow:0 35px 70px rgba(0,0,0,.75)
}

h1{text-align:center;margin-bottom:18px}

/* GRID */
.grid{
    display:grid;
    grid-template-columns:1fr 1fr;
    gap:14px
}

.card{
    position:relative;
    background:rgba(255,255,255,.05);
    border-radius:18px;
    padding:16px;
    text-align:center
}

.visual{
    font-size:60px;
    user-select:none
}

/* üî• GLOBAL BUTTON (NORMAL) */
button{
    width:100%;
    margin-top:8px;
    padding:12px;
    border-radius:14px;
    border:none;
    cursor:pointer;
    font-weight:600;
    color:#eaf0ff;
    background:linear-gradient(135deg,#2a3355,#1a2140)
}

/* ‚öôÔ∏è SETTINGS BUTTON ‚Äî FIXED FOREVER */
.settings-btn{
    position:absolute;
    top:8px;
    right:8px;

    width:auto !important;
    min-width:unset;
    max-width:none;

    margin:0;
    padding:4px 6px;

    font-size:13px;
    line-height:1;
    border-radius:8px;
    border:none;

    background:rgba(255,255,255,.15);
    color:#fff;
    cursor:pointer;
}
.settings-btn:hover{
    background:rgba(255,255,255,.25);
}

/* SETTINGS PANEL */
.settings{
    display:none;
    margin-top:8px;
    background:rgba(0,0,0,.35);
    padding:8px;
    border-radius:10px;
    font-size:13px;
    text-align:left
}
.settings label{display:block;margin-bottom:6px}
.settings input{
    width:100%;
    padding:6px;
    border-radius:8px;
    border:none
}

/* ANIMATIONS */
.coin.flip{animation:flip .9s ease}
@keyframes flip{
    0%{transform:rotateY(0)}
    50%{transform:rotateY(540deg) scale(1.1)}
    100%{transform:rotateY(1080deg)}
}

.dice.roll{animation:roll .6s ease}
@keyframes roll{
    0%{transform:rotate(0)}
    40%{transform:rotate(180deg) scale(1.2)}
    100%{transform:rotate(360deg)}
}

/* LOGS */
.log{
    margin-top:10px;
    min-height:26px;
    font-size:14px;
    opacity:0;
    transform:translateY(10px);
    transition:.3s;
    word-break:break-word
}
.log.show{
    opacity:1;
    transform:translateY(0)
}

.movie{color:#ffd66b;font-weight:600}
a{color:#7cc7ff;text-decoration:none}
a:hover{text-decoration:underline}

/* WHEEL */
.wheel-box{text-align:center;margin-top:20px}
canvas{display:block;margin:10px auto}
.arrow{
    margin:-6px auto 0;
    width:0;height:0;
    border-left:10px solid transparent;
    border-right:10px solid transparent;
    border-top:18px solid #ffd66b
}
input{
    width:100%;
    margin-top:6px;
    padding:10px;
    border-radius:10px;
    border:none
}
.controls{
    display:flex;
    gap:8px;
    margin-top:8px
}
.controls button{flex:1}

/* HISTORY */
.history{
    margin-top:12px;
    background:rgba(255,255,255,.05);
    border-radius:14px;
    padding:10px;
    max-height:140px;
    overflow:auto;
    font-size:14px
}
.history-title{
    text-align:center;
    font-weight:600;
    margin-bottom:6px
}
.history ul{
    list-style:none;
    padding:0;
    margin:0
}
.history li{
    margin-bottom:4px
}

@media(max-width:420px){
    .grid{grid-template-columns:1fr}
}
</style>
</head>

<body>
<div class="box">
<h1>üé∞ –†–ï–®–ê–¢–ï–õ–¨</h1>

<div class="grid">

<!-- ü™ô MONETKA -->
<div class="card">
    <button class="settings-btn" onclick="toggle('coinSet')">‚öôÔ∏è</button>
    <div class="visual coin" id="coin">ü™ô</div>

    <div class="settings" id="coinSet">
        <label>–û—Ä—ë–ª<input id="eagleText" value="üé¨ –ö–ò–ù–û"></label>
        <label>–†–µ—à–∫–∞<input id="tailsText" value="üì∫ YouTube"></label>
    </div>

    <button onclick="coinFlip()">–ú–æ–Ω–µ—Ç–∫–∞</button>
    <div class="log" id="coinLog"></div>
</div>

<!-- üé≤ KUBIK -->
<div class="card">
    <button class="settings-btn" onclick="toggle('diceSet')">‚öôÔ∏è</button>
    <div class="visual dice" id="dice">üé≤</div>

    <div class="settings" id="diceSet">
        <label>–ú–∏–Ω–∏–º—É–º<input type="number" id="diceMin" value="1"></label>
        <label>–ú–∞–∫—Å–∏–º—É–º<input type="number" id="diceMax" value="3"></label>
    </div>

    <button onclick="rollDice()">–ö—É–±–∏–∫</button>
    <div class="log" id="diceLog"></div>
</div>

</div>

<!-- üé° WHEEL -->
<div class="wheel-box">
    <h3>üé° –ö–æ–ª–µ—Å–æ —Ñ–æ—Ä—Ç—É–Ω—ã</h3>
    <div class="arrow"></div>
    <canvas id="wheel" width="260" height="260"></canvas>

    <input id="sectorInput" placeholder="–¢–µ–∫—Å—Ç —Å–µ–∫—Ç–æ—Ä–∞ –∏–ª–∏ URL">
    <div class="controls">
        <button onclick="addSector()">‚ûï –î–æ–±–∞–≤–∏—Ç—å</button>
        <button onclick="resetWheel()">üîÑ –°–±—Ä–æ—Å</button>
    </div>

    <button style="margin-top:10px" onclick="spinWheel()">üé∞ –ö–†–£–¢–ò–¢–¨</button>
    <div class="log" id="wheelLog"></div>

    <div class="history">
        <div class="history-title">üìú –ò—Å—Ç–æ—Ä–∏—è –≤—ã–ø–∞–¥–µ–Ω–∏–π</div>
        <ul id="wheelHistory"></ul>
    </div>
</div>

</div>

<script>
/* helpers */
function toggle(id){
    const e=document.getElementById(id);
    e.style.display=e.style.display==='block'?'none':'block'
}
function showLog(id,html){
    const el=document.getElementById(id);
    el.classList.remove('show');
    el.innerHTML=html;
    requestAnimationFrame(()=>el.classList.add('show'))
}
function isURL(t){
    return /^(https?:\/\/)/i.test(t)
}
function formatItem(t){
    return isURL(t)
        ? `<a href="${t}" target="_blank" rel="noopener">${t}</a>`
        : t
}

/* AUDIO */
const audio=new(window.AudioContext||window.webkitAudioContext)();
function clickSound(f=900){
    const o=audio.createOscillator(),g=audio.createGain();
    o.type="square";o.frequency.value=f;
    g.gain.value=.07;
    o.connect(g).connect(audio.destination);
    o.start();o.stop(audio.currentTime+.03)
}
function bell(){
    const o=audio.createOscillator(),g=audio.createGain();
    o.type="sine";o.frequency.value=1200;
    g.gain.setValueAtTime(.2,audio.currentTime);
    g.gain.exponentialRampToValueAtTime(.001,audio.currentTime+.6);
    o.connect(g).connect(audio.destination);
    o.start();o.stop(audio.currentTime+.7)
}

/* MONETKA */
function coinFlip(){
    coin.classList.remove('flip');void coin.offsetWidth;coin.classList.add('flip');
    clickSound(2000);
    showLog(
        'coinLog',
        Math.random()<.5
        ? `ü™ô –û—Ä—ë–ª ‚Üí <span class="movie">${eagleText.value}</span>`
        : `ü™ô –†–µ—à–∫–∞ ‚Üí <span class="movie">${tailsText.value}</span>`
    )
}

/* KUBIK */
function rollDice(){
    dice.classList.remove('roll');void dice.offsetWidth;dice.classList.add('roll');
    clickSound(600);
    const min=+diceMin.value,max=+diceMax.value;
    if(min>max)return showLog('diceLog','‚ö†Ô∏è –ù–µ–≤–µ—Ä–Ω—ã–π –¥–∏–∞–ø–∞–∑–æ–Ω');
    const n=Math.floor(Math.random()*(max-min+1))+min;
    showLog('diceLog',`üé≤ –í—ã–ø–∞–ª–æ: <span class="movie">${n}</span>`)
}

/* WHEEL */
const ctx=wheel.getContext('2d');
let sectors=[],angle=0,spinning=false,history=[];

function draw(){
    ctx.clearRect(0,0,260,260);
    const cx=130,cy=130,r=130;

    if(sectors.length){
        const step=2*Math.PI/sectors.length;
        sectors.forEach((t,i)=>{
            ctx.beginPath();
            ctx.moveTo(cx,cy);
            ctx.fillStyle=`hsl(${i*360/sectors.length},70%,45%)`;
            ctx.arc(cx,cy,r,i*step+angle,(i+1)*step+angle);
            ctx.fill();

            ctx.save();
            ctx.translate(cx,cy);
            ctx.rotate(i*step+step/2+angle);
            ctx.fillStyle="#fff";
            ctx.font="14px system-ui,Arial";
            ctx.textAlign="right";
            ctx.textBaseline="middle";

            let label=t;
            while(ctx.measureText(label+'‚Ä¶').width>95&&label.length){
                label=label.slice(0,-1)
            }
            if(label!==t)label+='‚Ä¶';
            ctx.fillText(label,r-14,0);
            ctx.restore();
        })
    }

    ctx.beginPath();
    ctx.arc(cx,cy,r-1,0,Math.PI*2);
    ctx.strokeStyle="#ffd66b";
    ctx.lineWidth=2;
    ctx.stroke()
}
draw();

function updateHistory(){
    wheelHistory.innerHTML='';
    history.forEach((h,i)=>{
        const li=document.createElement('li');
        li.innerHTML=`${i+1}. ${formatItem(h)}`;
        wheelHistory.appendChild(li)
    })
}

function spinWheel(){
    if(sectors.length<2||spinning)return;
    spinning=true;

    let speed=Math.random()*.4+.3;
    let last=null;

    const spin=setInterval(()=>{
        angle+=speed;
        speed*=.985;
        draw();

        const step=2*Math.PI/sectors.length;
        const idx=Math.floor(((2*Math.PI-angle%(2*Math.PI))%(2*Math.PI))/step);

        if(idx!==last){clickSound();last=idx}

        if(speed<.005){
            clearInterval(spin);
            spinning=false;
            const res=sectors.splice(idx,1)[0];
            history.push(res);
            updateHistory();
            draw();
            bell();
            showLog('wheelLog',`üé° –í—ã–ø–∞–ª–æ: ${formatItem(res)}`)
        }
    },20)
}

function addSector(){
    if(!sectorInput.value.trim())return;
    sectors.push(sectorInput.value.trim());
    sectorInput.value='';
    draw()
}
function resetWheel(){
    sectors=[];history=[];
    updateHistory();
    showLog('wheelLog','');
    draw()
}
</script>
</body>
</html>
